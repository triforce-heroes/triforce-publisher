import{writeFileSync as e}from"node:fs";import{fatal as r}from"@triforce-heroes/triforce-core/Console";import{loadEngineDriver as o,loadSourceDriver as s}from"../drivers/index.js";export async function PrepareCommand(t,i,n){let d=s(i);void 0===d&&r(`Unsupported source driver: ${i}`);let p=o(t);void 0===p&&r(`Unsupported engine driver: ${t}`),process.stdout.write("Compiling entries... ");let c=await d.entries(n,p);for(let[r,o]of(process.stdout.write("OK\n"),process.stdout.write("Reassigning entries to locales... "),Object.entries(d.reassignLocales(c))))e(`entries_${r}.json`,JSON.stringify(o,null,2));process.stdout.write("OK\n"),process.stdout.write("\nDONE!")}